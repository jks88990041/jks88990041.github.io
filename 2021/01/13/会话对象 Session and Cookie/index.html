<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>会话对象 Session and Cookie | 一只柴犬</title><meta name="description" content="@[TOC](会话对象Session and Cookie ) 学习目标 熟练掌握Cookie的概念,使用,及生命周期; 能够使用Cookie存储中文并了解Cookie的路径作用; 掌握Session的原理及使用方法; 能够详细说明Cookie和Session的区别; 能够独立完成自动登陆  Cookie概述(熟练)什么叫CookieCookie翻译成中文是小甜点，小饼干的意思。在HTTP中它表示"><meta name="author" content="凯凯超人"><meta name="copyright" content="凯凯超人"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2021/01/13/%E4%BC%9A%E8%AF%9D%E5%AF%B9%E8%B1%A1%20Session%20and%20Cookie/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="会话对象 Session and Cookie"><meta property="og:url" content="http://yoursite.com/2021/01/13/%E4%BC%9A%E8%AF%9D%E5%AF%B9%E8%B1%A1%20Session%20and%20Cookie/"><meta property="og:site_name" content="一只柴犬"><meta property="og:description" content="@[TOC](会话对象Session and Cookie ) 学习目标 熟练掌握Cookie的概念,使用,及生命周期; 能够使用Cookie存储中文并了解Cookie的路径作用; 掌握Session的原理及使用方法; 能够详细说明Cookie和Session的区别; 能够独立完成自动登陆  Cookie概述(熟练)什么叫CookieCookie翻译成中文是小甜点，小饼干的意思。在HTTP中它表示"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/media/image/14.jpg"><meta property="article:published_time" content="2021-01-13T11:28:03.179Z"><meta property="article:modified_time" content="2021-01-13T11:28:10.355Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="JSP" href="http://yoursite.com/2021/01/14/JSP/"><link rel="next" title="请求对象和响应对象 request and response" href="http://yoursite.com/2021/01/11/%E8%AF%B7%E6%B1%82%E5%AF%B9%E8%B1%A1%E5%92%8C%E5%93%8D%E5%BA%94%E5%AF%B9%E8%B1%A1%20request%20and%20response/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/pool.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/iconfont.min.css"><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/hideCategory.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/macWhite.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/font-awesome-animation.min.css"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="一只柴犬" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/admin.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">31</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw https://dh.xiaokang.me/"></i><span> 搜索</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw faa-pulse animated"></i><span> 一只柴犬</span></a></div><div class="menus_item"><a class="site-page"><span> 关注我</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw faa-shake animated-hover"></i><span> 留言板</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw faa-pulse"></i><span> 关于我</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-link"></i><span> 友情链接</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw faa-rising animated-hover"></i><span> 友情链接</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw faa-falling animated-hover"></i><span> 网址收藏</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-book"></i><span> 找文章</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-tags"></i><span> 归档</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-tags"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 放轻松</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 小功能</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-lemon"></i><span> Iconfont库</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-snowflake"></i><span> 表情速查</span></a></li></ul></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#学习目标"><span class="toc-number">1.</span> <span class="toc-text">学习目标</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cookie概述-熟练"><span class="toc-number">2.</span> <span class="toc-text">Cookie概述(熟练)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么叫Cookie"><span class="toc-number">2.1.</span> <span class="toc-text">什么叫Cookie</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie的作用"><span class="toc-number">2.2.</span> <span class="toc-text">Cookie的作用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cookie示例-精通"><span class="toc-number">3.</span> <span class="toc-text">Cookie示例(精通)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#保存Cookie到客户端"><span class="toc-number">3.1.</span> <span class="toc-text">保存Cookie到客户端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#服务器端读取Cookie"><span class="toc-number">3.2.</span> <span class="toc-text">服务器端读取Cookie</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cookie生命周期-熟练"><span class="toc-number">4.</span> <span class="toc-text">Cookie生命周期(熟练)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cookie的路径-不常用"><span class="toc-number">5.</span> <span class="toc-text">Cookie的路径(不常用)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie的path属性"><span class="toc-number">5.1.</span> <span class="toc-text">Cookie的path属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie-路径的作用"><span class="toc-number">5.2.</span> <span class="toc-text">Cookie 路径的作用:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie路径的使用"><span class="toc-number">5.3.</span> <span class="toc-text">Cookie路径的使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cookie保存中文-熟练-Tom9是可以使用中文的-针对Tom7版本"><span class="toc-number">6.</span> <span class="toc-text">Cookie保存中文(熟练) Tom9是可以使用中文的 针对Tom7版本</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HttpSession概述-熟练"><span class="toc-number">7.</span> <span class="toc-text">HttpSession概述(熟练)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HttpSession原理（依赖Cookie）"><span class="toc-number">8.</span> <span class="toc-text">HttpSession原理（依赖Cookie）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HttpSession失效-精通"><span class="toc-number">9.</span> <span class="toc-text">HttpSession失效(精通)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#面试题"><span class="toc-number">10.</span> <span class="toc-text">面试题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Session和Cookie的区别-精通"><span class="toc-number">10.1.</span> <span class="toc-text">Session和Cookie的区别(精通)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#综合练习-精通-使用cookie实现自动登录"><span class="toc-number">11.</span> <span class="toc-text">综合练习(精通) 使用cookie实现自动登录</span></a></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/media/image/14.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">一只柴犬</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw https://dh.xiaokang.me/"></i><span> 搜索</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw faa-pulse animated"></i><span> 一只柴犬</span></a></div><div class="menus_item"><a class="site-page"><span> 关注我</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw faa-shake animated-hover"></i><span> 留言板</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw faa-pulse"></i><span> 关于我</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-link"></i><span> 友情链接</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw faa-rising animated-hover"></i><span> 友情链接</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw faa-falling animated-hover"></i><span> 网址收藏</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-book"></i><span> 找文章</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-tags"></i><span> 归档</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-tags"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 放轻松</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 小功能</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-lemon"></i><span> Iconfont库</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-snowflake"></i><span> 表情速查</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">会话对象 Session and Cookie</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2021-01-13 19:28:03"><i class="far fa-calendar-alt fa-fw"></i> Created 2021-01-13</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2021-01-13 19:28:10"><i class="fas fa-history fa-fw"></i> Updated 2021-01-13</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>@[TOC](会话对象<br>Session and Cookie )</p>
<h1 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h1><ul>
<li>熟练掌握Cookie的概念,使用,及生命周期;</li>
<li>能够使用Cookie存储中文并了解Cookie的路径作用;</li>
<li>掌握Session的原理及使用方法;</li>
<li><strong>能够详细说明Cookie和Session的区别;</strong></li>
<li><strong>能够独立完成自动登陆</strong></li>
</ul>
<h1 id="Cookie概述-熟练"><a href="#Cookie概述-熟练" class="headerlink" title="Cookie概述(熟练)"></a>Cookie概述(熟练)</h1><h2 id="什么叫Cookie"><a href="#什么叫Cookie" class="headerlink" title="什么叫Cookie"></a>什么叫Cookie</h2><p>Cookie翻译成中文是小甜点，小饼干的意思。<strong>在HTTP中它表示服务器送给客户端浏览器的小甜点。</strong>其实Cookie就是一个键和一个值构成的，<strong>随着服务器端的响应发送给客户端浏览器</strong>。<strong>然后客户端浏览器会把Cookie保存起来，<em>当下一次再访问服务器时把Cookie再发送给服务器</em>。</strong><br>不同的浏览器不共享Cookie</p>
<h2 id="Cookie的作用"><a href="#Cookie的作用" class="headerlink" title="Cookie的作用"></a>Cookie的作用</h2><p>Cookie的作用可大了，但无论怎么夸大Cookie的作用都离不开“<strong>跟踪客户端状态</strong>”这句话。</p>
<ol>
<li>Cookie是服务器保存在客户端的信息</li>
<li>然后客户端会在下次请求时把Cookie在还给服务器</li>
<li>服务器就可以通过信息来识别客户端了<h1 id="Cookie示例-精通"><a href="#Cookie示例-精通" class="headerlink" title="Cookie示例(精通)"></a>Cookie示例(精通)</h1><h2 id="保存Cookie到客户端"><a href="#保存Cookie到客户端" class="headerlink" title="保存Cookie到客户端"></a>保存Cookie到客户端</h2>这是响应工作的一部分，所以这个方法是response对象的。并且<strong>Cookie是HTTP协议中的内容</strong>，所以<strong>保存Cookie是HttpServletResponse类的方法</strong>。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建一个Cookie</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"username"</span>,<span class="string">"chaiquan"</span>);</span><br><span class="line"><span class="comment">//把cookie添加到响应对象内</span></span><br><span class="line">resp.addCookie(cookie);</span><br></pre></td></tr></table></figure>
<p>访问路径后，可以在请求的响应头中看到所存入的cookie<br><img src= "/img/loading.gif" data-src="https://img-blog.csdnimg.cn/20210112151657647.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2prczg4OTk1NjU2,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>可以看到Response Headers 中 Set-Cookie 中存入了刚才我们放的cookie信息。同样根据浏览器的开发者工具我们可以看到<code>http://localhost:8080</code>的网址的cookie中被加入了username=chaiquan的信息:</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdnimg.cn/20210112151923827.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2prczg4OTk1NjU2,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br><strong>注意：</strong></p>
<ul>
<li>不同次的存入cookie，因为键是唯一的，相同键的值会被覆盖。同一时间只能够存在唯一的一对键值对。</li>
<li>同时后续请求，请求头都会带上存储的Cookie<h2 id="服务器端读取Cookie"><a href="#服务器端读取Cookie" class="headerlink" title="服务器端读取Cookie"></a>服务器端读取Cookie</h2>如果浏览器保存了Cookie，那么会在下一次请求时把Cookie放到<strong>请求头</strong>中发送给服务器，这时服务器需要<strong>在请求中读取Cookie</strong>。既然是<strong>在请求中读取</strong>，那么当然是<strong>使用request对象</strong>来读取了。<br>循环遍历Cookie 的每一条键值对 cookie 取键与取值的方法为</li>
<li>取键 cookie.getName();</li>
<li>取值 cookie.getValue();</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Cookie[] cookies = req.getCookies();</span><br><span class="line"><span class="keyword">if</span>(cookies != <span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(Cookie cookie : cookies)&#123;</span><br><span class="line">    <span class="comment">//输出所有的键值对</span></span><br><span class="line">        System.out.println(cookie.getName() +<span class="string">":"</span>+ cookie.getValue());</span><br><span class="line">        <span class="comment">//去对应键的值</span></span><br><span class="line">        <span class="keyword">if</span>(cookie.getName().equals(<span class="string">"username"</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">"输出username的值"</span>);</span><br><span class="line">            System.out.println(cookie.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Cookie生命周期-熟练"><a href="#Cookie生命周期-熟练" class="headerlink" title="Cookie生命周期(熟练)"></a>Cookie生命周期(熟练)</h1><p>Cookie会在客户端存活多久呢？这就是Cookie的生命了。<strong>默认情况下，Cookie只在浏览器的内存中存活</strong>，也就是说，<strong>当你关闭浏览器后，Cookie就会消失</strong>！<br>可以使用<code>Cookie#setMaxAge(int expiry)</code>来设置Cookie的存活时间。<strong>参数expiry表示Cookie存活的秒数</strong>。</p>
<ul>
<li>cookie.setMaxAge(60*60)：表示cookie对象可存活1小时。就算关闭浏览器，就算重启客户端电脑，cookie也会存活1小时。因为当maxAge大于0时，浏览器不仅会把cookie保存在浏览器内存中，还会把cookie保存到硬盘上。</li>
<li>cookie.setMaxAge(-1)：cookie的maxAge属性的默认值就是-1（其实只要是负数都是一个意思），表示只在浏览器内存中存活。一旦关闭浏览器窗口，那么cookie就会消失。</li>
<li>cookie.setMaxAge(0)：cookie被作废！表示cookie即不在内存中存活，也不在硬盘上存活，这<strong>样的cookie设置只有一个目的，那就是覆盖客户端原来的这个cookie，使其作废</strong>。<h1 id="Cookie的路径-不常用"><a href="#Cookie的路径-不常用" class="headerlink" title="Cookie的路径(不常用)"></a>Cookie的路径(不常用)</h1><h2 id="Cookie的path属性"><a href="#Cookie的path属性" class="headerlink" title="Cookie的path属性"></a>Cookie的path属性</h2>Cookie还有一个path属性，可以通过Cookie#setPath(String)方法来设置。这个路径就是请求的路径。例如在请求:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/cookie_demo/path</span><br></pre></td></tr></table></figure>
<p>服务器响应了一个Cookie，那么这个Cookie的默认路径是/cookie_demo。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/cookie_demo/path/son</span><br></pre></td></tr></table></figure>

<p>服务器响应了一个Cookie，那么这个Cookie的默认路径就是/cookie_demo/path。<br>其可以在浏览器当中查看。例如谷歌浏览器：<br><img src= "/img/loading.gif" data-src="https://img-blog.csdnimg.cn/20210112185659870.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2prczg4OTk1NjU2,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="Cookie-路径的作用"><a href="#Cookie-路径的作用" class="headerlink" title="Cookie 路径的作用:"></a>Cookie 路径的作用:</h2><ul>
<li><p>首先声明一点，path不是指Cookie在客户端存放的路径！！！不同的浏览器存放Cookie的路径是不同的！！！你不能通过Cookie的path来指定Cookie文件的存放路径！！！</p>
<p>假设你的浏览器当前已经有了两个Cookie：</p>
</li>
</ul>
<ul>
<li>cookie1:name=path1;value=pathvalue1;path=/cookie_demo</li>
<li>cookie2:name=path1;value=pathvalue2;path=/cookie_demo/path</li>
</ul>
<p>区别在于</p>
<ul>
<li>当访问<a href="http://localhost:8080/cookie_demo/*时，请求头中会包含cookie1，而不会包含cookie2。" target="_blank" rel="noopener">http://localhost:8080/cookie_demo/*时，请求头中会包含cookie1，而不会包含cookie2。</a></li>
<li>当访问<a href="http://localhost:8080/cookie_demo/path/*时，请求头中会包含cookie1和cookie2。" target="_blank" rel="noopener">http://localhost:8080/cookie_demo/path/*时，请求头中会包含cookie1和cookie2。</a></li>
</ul>
<p><strong>也就是说，在访问子路径时，会包含其父路径的Cookie，而在访问父路径时，不包含子路径的Cookie。</strong></p>
<h2 id="Cookie路径的使用"><a href="#Cookie路径的使用" class="headerlink" title="Cookie路径的使用"></a>Cookie路径的使用</h2><p>如果你想在BServlet中设置的Cookie，在客户端访问AServlet时也包含在请求头中，那么就需要设置BServlet中的Cookie的path：</p>
<ul>
<li>c2.setPath(“/cookie_demo”)：硬编码；</li>
<li>c2.setPath(request.getContextpath() + “/”)：活编码。</li>
</ul>
<p>这样就可以设置Cookie的路径，保存在访问AServlet时，也会包含BServlet中添加的Cookie。<br>Cookie的SetPath设置cookie的路径，这个路径直接决定服务器的请求是否会从浏览器中加载某些cookie。</p>
<blockquote>
<p>首先默认情况如果不设置cookie的path，默认是 /项目名称/当前路径的上一层地址如：<br>请求路径：/cookie_demo/servlet/login，<br>cookie的路径：/cookie_demo/servlet</p>
</blockquote>
<p>如果我们设置path，如果当前访问的路径包含了cookie的路径（当前访问路径在cookie路径基础上要比cookie的范围小）cookie就会加载到request对象之中。</p>
<h1 id="Cookie保存中文-熟练-Tom9是可以使用中文的-针对Tom7版本"><a href="#Cookie保存中文-熟练-Tom9是可以使用中文的-针对Tom7版本" class="headerlink" title="Cookie保存中文(熟练) Tom9是可以使用中文的 针对Tom7版本"></a>Cookie保存中文(熟练) Tom9是可以使用中文的 针对Tom7版本</h1><p>Tom7 中  。Cookie中是不可以设置中文的，但可以使用<code>URLEncodor.encode()</code>方法<strong>编码</strong>后在存放到Cookie中。在获取Cookie时，需要先使用<code>URLDecoder.decode()</code>方法<strong>解码</strong>，再使用。<br>添加cookie:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建一个Cookie</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"username"</span>,<span class="string">"柴犬"</span>);</span><br><span class="line"><span class="comment">//编码 </span></span><br><span class="line">URLEncoder.encode(username,<span class="string">"UTF-8"</span>));</span><br></pre></td></tr></table></figure>
<p>读取cookie:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"><span class="keyword">if</span>(cookies != <span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(Cookie cookie : cookies)&#123;</span><br><span class="line">        <span class="keyword">if</span>(cookie.getName().equals(<span class="string">"username"</span>))</span><br><span class="line">        	<span class="comment">//解码</span></span><br><span class="line">            username = URLDecoder.decode(cookie.getValue(),<span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="keyword">if</span>(cookie.getName().equals(<span class="string">"password"</span>))</span><br><span class="line">            password = cookie.getValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="HttpSession概述-熟练"><a href="#HttpSession概述-熟练" class="headerlink" title="HttpSession概述(熟练)"></a>HttpSession概述(熟练)</h1><p>会话跟踪之session</p>
<blockquote>
<p><strong>session也是域对象之一</strong>，它的范围是在一个会话范围内有效。session既然是域对象，那么当然就要有<code>getAttribute()</code>和<code>setAttribute()</code>系列方法了。<br>在一个会话内共享一个session对象，所以session中可以保存一个会话内的数据。例如当前用户的信息。</p>
</blockquote>
<ul>
<li>session的范围大于request，<strong>可以在一个会话中多个请求之间共享数据</strong>。</li>
<li>但session的范围小于ServletContext(application)，<strong>session不能在多个用户之间共享数据</strong>。</li>
</ul>
<p>目前所学过的域对象的作用范围：</p>
<blockquote>
<pre><code>**ServletContext &gt;    HttpSession    &gt;    HttpServletRequest**</code></pre></blockquote>
<p><strong>获取session对象</strong></p>
<ul>
<li><p>使用<code>request.getSession()</code>方法就可以获取session对象。 <strong>存入的键值对参数，是存在sussionid对应的session对象中，存在于服务器的session池中</strong></p>
<p>类TxUser</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TxUser</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TxUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TxUser</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"TxUser&#123;"</span> +</span><br><span class="line">                <span class="string">"username='"</span> + username + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", password='"</span> + password + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Session_demo1 存入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取请求对象</span></span><br><span class="line">HttpSession session = req.getSession();</span><br><span class="line"><span class="comment">//向session内存入内容</span></span><br><span class="line">session.setAttribute(<span class="string">"username"</span>,<span class="string">"chaiquan"</span>);</span><br><span class="line">session.setAttribute(<span class="string">"txuser"</span>,<span class="keyword">new</span> TxUser(<span class="string">"admin"</span>,<span class="string">"123456"</span>));</span><br><span class="line">resp.getWriter().write(<span class="string">"success!!!"</span>);</span><br></pre></td></tr></table></figure>
<p>Session_demo2 读取</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取请求对象</span></span><br><span class="line">HttpSession session = req.getSession();</span><br><span class="line"><span class="comment">//向session内存入内容</span></span><br><span class="line">session.setAttribute(<span class="string">"username"</span>,<span class="string">"chaiquan"</span>);</span><br><span class="line">session.setAttribute(<span class="string">"txuser"</span>,<span class="keyword">new</span> TxUser(<span class="string">"admin"</span>,<span class="string">"123456"</span>));</span><br></pre></td></tr></table></figure>

<p><strong>有了session，就不用使用Cookie来跟踪会话了</strong>！但是session不能像Cookie那样长命，一旦用户关闭浏览器窗口，那么session就死掉了。但在请求，服务器会分配一个新的session对象给他。</p>
<h1 id="HttpSession原理（依赖Cookie）"><a href="#HttpSession原理（依赖Cookie）" class="headerlink" title="HttpSession原理（依赖Cookie）"></a>HttpSession原理（依赖Cookie）</h1><p><img src= "/img/loading.gif" data-src="https://img-blog.csdnimg.cn/20210112215401736.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2prczg4OTk1NjU2,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<blockquote>
<p>HTTP是无状态协议，<strong>但是为什么session可以跟踪会话状态呢</strong>？ 因为session依赖Cookie。</p>
</blockquote>
<ol>
<li>当客户端第一次访问服务器时，服务器会为客户端创建一个session对象，然后把session对象放到session池中，在响应时把<strong>sessionId通过Cookie响应</strong>给客户端。注意，<strong>只有在第一次访问时，服务器才会创建session，给客户端响应sessionId</strong>。从此以后就不会了！</li>
<li>当<strong>客户端再次访问服务器时，会在请求中带着sessionId给服务器</strong>，<strong>服务器通过sessionId到session池中找到session对象，这就可以完成会话跟踪了</strong>。也就是说，服务器端保存的是session对象，而客户端只有sessionId。每次访问都需要通过客户端的sessionId来匹配服务器端的session对象！这样用户在session中保存的数据就可以再次被使用了。</li>
<li>sessionId是服务器通过Cookie发送给客户端浏览器的，<strong>这个Cookie的maxAge为-1</strong>，即只在浏览器内存中存在。如果你关闭所有浏览器窗口，那么这个Cookie（Session）就会消失了！</li>
</ol>
<h1 id="HttpSession失效-精通"><a href="#HttpSession失效-精通" class="headerlink" title="HttpSession失效(精通)"></a>HttpSession失效(精通)</h1><p>session失效有如下几个原因：</p>
<ol>
<li>session.invalidate()方法注销session</li>
<li>session超时</li>
</ol>
<p>在web.xml中添加</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;session-config&gt;</span><br><span class="line">    &lt;!-- session的超时时间，以分钟为单位 --&gt;</span><br><span class="line">    &lt;session-timeout&gt;1&lt;/session-timeout&gt;</span><br><span class="line">&lt;/session-config&gt;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Cookie被禁用</li>
</ol>
<h1 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h1><h2 id="Session和Cookie的区别-精通"><a href="#Session和Cookie的区别-精通" class="headerlink" title="Session和Cookie的区别(精通)"></a>Session和Cookie的区别(精通)</h2><ul>
<li>session 存在服务器端，cookie 存在客户端（浏览器）</li>
<li>session 默认被存在在服务器的一个文件里（不是内存）</li>
<li>session 的运行<strong>依赖 session id</strong>，而 session id 是存在 cookie 中的，也就是说，如果浏览器禁用了 cookie ，同时 session 也会失效（但是可以通过其它方式实现，比如在 url 中传递 session_id）</li>
<li>session 可以放在 文件、数据库、或内存中都可以。</li>
<li>用户验证这种场合一般会用 session 因此，维持一个会话的核心就是客户端的唯一标识，即 session id</li>
</ul>
<h1 id="综合练习-精通-使用cookie实现自动登录"><a href="#综合练习-精通-使用cookie实现自动登录" class="headerlink" title="综合练习(精通) 使用cookie实现自动登录"></a>综合练习(精通) 使用cookie实现自动登录</h1><p>具体实现流程如图所示：<br><img src= "/img/loading.gif" data-src="https://img-blog.csdnimg.cn/20210112230225355.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2prczg4OTk1NjU2,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>login.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"login"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    用户:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">value</span>=<span class="string">"1"</span> <span class="attr">name</span>=<span class="string">"auto"</span>/&gt;</span><span class="symbol">&amp;nbsp;</span>一天内自动登陆<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登陆"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Login的Servlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//设置响应对象的编码</span></span><br><span class="line">        resp.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">        resp.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">        <span class="comment">//获取用户名与密码</span></span><br><span class="line">        String username = req.getParameter(<span class="string">"username"</span>);</span><br><span class="line">        String password = req.getParameter(<span class="string">"password"</span>);</span><br><span class="line">        <span class="comment">//判断是否传递参数</span></span><br><span class="line">        <span class="keyword">if</span> (username == <span class="keyword">null</span> &amp;&amp; password == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">//获取cookies</span></span><br><span class="line">            <span class="comment">//字符串</span></span><br><span class="line">            String txStr =<span class="string">""</span>;</span><br><span class="line">            Cookie[] cookies = req.getCookies();</span><br><span class="line">            <span class="keyword">if</span>(cookies != <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">for</span>(Cookie cookie : cookies)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (cookie.getName().equals(<span class="string">"txuser1"</span>))&#123;</span><br><span class="line">                        txStr = cookie.getValue();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//判断是否有用户cookie</span></span><br><span class="line">            <span class="keyword">if</span> (txStr.equals(<span class="string">""</span>))&#123;</span><br><span class="line">                resp.getWriter().write(<span class="string">"你没登录呢"</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                BASE64Decoder decoder = <span class="keyword">new</span> BASE64Decoder();</span><br><span class="line">                txStr = <span class="keyword">new</span> String(decoder.decodeBuffer(txStr));</span><br><span class="line">                <span class="comment">//划分：内容</span></span><br><span class="line">                String[] split = txStr.split(<span class="string">":"</span>);</span><br><span class="line">                <span class="keyword">if</span>(split[<span class="number">0</span>].equals(<span class="string">"admin"</span>) &amp;&amp; split.equals(<span class="string">"123456"</span>))&#123;</span><br><span class="line">                    TxUser txUser = <span class="keyword">new</span> TxUser(split[<span class="number">0</span>],split[<span class="number">1</span>]);</span><br><span class="line">                    req.getSession().setAttribute(<span class="string">"txuser"</span>,txUser);</span><br><span class="line">                    resp.getWriter().write(<span class="string">"欢迎你大哥"</span>+txUser.getUsername());</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    resp.getWriter().write(<span class="string">"大神啊，你得重新登录"</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//判断用户名或者摩玛是否正确   正常应该是数据库</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(username)&amp;&amp; <span class="string">"123456"</span>.equals(password))&#123;</span><br><span class="line">                <span class="comment">//输入正确 获取用户，存入session</span></span><br><span class="line">                <span class="comment">//创建一个用户</span></span><br><span class="line">                TxUser txUser = <span class="keyword">new</span> TxUser(username,password);</span><br><span class="line">                <span class="comment">//用户对象 存入session</span></span><br><span class="line">                HttpSession session = req.getSession();</span><br><span class="line">                session.setAttribute(<span class="string">"txuser"</span>,txUser);</span><br><span class="line">                <span class="comment">//获取是否勾选自动登录 auto是name的参数</span></span><br><span class="line">                String auto = req.getParameter(<span class="string">"auto"</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">"1"</span>.equals(auto))&#123;</span><br><span class="line">                    <span class="comment">//admin:123456</span></span><br><span class="line">                    String str = txUser.getUsername()+<span class="string">":"</span>+txUser.getPassword();</span><br><span class="line">                    <span class="comment">//使用BASE64编码格式</span></span><br><span class="line">                    BASE64Encoder encoder = <span class="keyword">new</span> BASE64Encoder();</span><br><span class="line">                    str = encoder.encode(str.getBytes());</span><br><span class="line">                    Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"txuser1"</span>,str);</span><br><span class="line">                    resp.addCookie(cookie);</span><br><span class="line">                    resp.getWriter().write(<span class="string">"欢迎你奥 你设置了自动登录"</span>+txUser.getUsername());</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    resp.getWriter().write(<span class="string">"欢迎你奥 不过你没有设置自动登录"</span>+txUser.getUsername());</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//账号密码对不上</span></span><br><span class="line">                resp.getWriter().write(<span class="string">"用户名或密码错误"</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TxUser类</p>
<pre><code class="java"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TxUser</span> </span>{
    <span class="keyword">private</span> String username;
    <span class="keyword">private</span> String password;

    <span class="function"><span class="keyword">public</span> <span class="title">TxUser</span><span class="params">()</span> </span>{
    }

    <span class="function"><span class="keyword">public</span> <span class="title">TxUser</span><span class="params">(String username, String password)</span> </span>{
        <span class="keyword">this</span>.username = username;
        <span class="keyword">this</span>.password = password;
    }

    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>{
        <span class="keyword">return</span> username;
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>{
        <span class="keyword">this</span>.username = username;
    }

    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>{
        <span class="keyword">return</span> password;
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>{
        <span class="keyword">this</span>.password = password;
    }

    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{
        <span class="keyword">return</span> <span class="string">"TxUser{"</span> +
                <span class="string">"username='"</span> + username + <span class="string">'\''</span> +
                <span class="string">", password='"</span> + password + <span class="string">'\''</span> +
                <span class="string">'}'</span>;
    }
}</code></pre>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">凯凯超人</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2021/01/13/%E4%BC%9A%E8%AF%9D%E5%AF%B9%E8%B1%A1%20Session%20and%20Cookie/">http://yoursite.com/2021/01/13/%E4%BC%9A%E8%AF%9D%E5%AF%B9%E8%B1%A1%20Session%20and%20Cookie/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/media/image/14.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><button class="reward-button"><i class="fas fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="wechat" onclick="window.open('/img/wechat.jpg')"/><div class="post-qr-code__desc">wechat</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="alipay" onclick="window.open('/img/alipay.jpg')"/><div class="post-qr-code__desc">alipay</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/01/14/JSP/"><img class="prev-cover" data-src="https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/13/163a2ade4361d1ed705ed523091af67e.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">JSP</div></div></a></div><div class="next-post pull-right"><a href="/2021/01/11/%E8%AF%B7%E6%B1%82%E5%AF%B9%E8%B1%A1%E5%92%8C%E5%93%8D%E5%BA%94%E5%AF%B9%E8%B1%A1%20request%20and%20response/"><img class="next-cover" data-src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/media/image/14.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">请求对象和响应对象 request and response</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 凯凯超人</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="http://www.beian.gov.cn" target="_blank"><img class="lozad" data-src="/img/icp.png" onerror="onerror=null;src='/img/icp.png'" style="padding:0px;vertical-align: text-bottom;"/><span>浙ICP备12345678号</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font_plus" title="Increase Font Size"><i class="fas fa-plus"></i></button><button id="font_minus" title="Decrease Font Size"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/pool.js"></script><script src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/hideCategory.min.js"></script></body></html>